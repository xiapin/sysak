---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by liaozhaoyan.
--- DateTime: 2023/8/15 12:55 AM
---

local module = {}

local lineParse = require("common.lineParse")
local CprotoData = require("common.protoData")
local system = require("common.system")
local pysting = require("common.pystring")

local function protoLine(line)
    local title, ls, vs, log = lineParse.parse(line)

    local lss = {}
    for k, v in pairs(ls) do
        table.insert(lss, {name = k, index = v})
    end

    local vss = {}
    for k, v in pairs(vs) do
        table.insert(vss, {name = k, value = v})
    end

    local logs = {}
    for k, v in pairs(log) do
        table.insert(logs, {name = k, log = v})
    end

    return {
        line = title,
        ls = lss,
        vs = vss,
        log = logs,
    }
end

local proto = CprotoData.new()
function module.protoLines(lines)
    local lineTable = {
        lines = {}
    }

    local s_lines = pysting:split(lines, "\n")
    for c, line in ipairs(s_lines) do
        lineTable.lines[c] = protoLine(line)
    end

    return proto:encode(lineTable)
end

return module
