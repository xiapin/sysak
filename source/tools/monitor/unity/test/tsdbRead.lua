---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by liaozhaoyan.
--- DateTime: 2022/12/17 1:32 PM
---

package.path = package.path .. ";../common/?.lua;"
package.path = package.path .. ";../tsdb/?.lua;"
package.path = package.path .. ";../tsdb/native/?.lua;"

local serpent = require("serpent")
local CfoxTSDB = require("foxTSDB")


local fox = CfoxTSDB.new()

local date = fox:getDate()
date = fox:moveSec(date, -60)
local us = fox:makeStamp(date)

fox:_setupRead(date, us)

date = fox:moveSec(date, -60)
us = fox:makeStamp(date)
local pos1 = fox:curMove(us)
date = fox:moveSec(date, 60)
us = fox:makeStamp(date)
local pos2 = fox:curMove(us)
date = fox:moveSec(date, -60)
us = fox:makeStamp(date)
local pos3 = fox:curMove(us)
date = fox:moveSec(date, 60)
us = fox:makeStamp(date)
local pos4 = fox:curMove(us)
date = fox:moveSec(date, -60)
us = fox:makeStamp(date)
local pos5 = fox:curMove(us)
assert(pos1 == pos3)
assert(pos3 == pos5)
assert( pos2 == pos4)
print("cursor pass.")

local start = fox:makeStamp(date)
date = fox:moveSec(date, 60)
local stop = fox:makeStamp(date)

fox:query(start, stop)
